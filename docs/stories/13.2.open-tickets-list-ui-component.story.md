# Story 13.2: Open Tickets List UI Component

## Status

Done

## Story

**As a** user,
**I want** to see clickable links for up to 3 open tickets when a contact is matched,
**so that** I can quickly add time to existing tickets instead of creating duplicates.

## Acceptance Criteria

1. Create `OpenTicketsList` component displaying clickable ticket links
2. Position between Client dropdown and Time input in TicketForm
3. Implement text truncation with ellipsis for descriptions
4. Add selection state management and visual feedback (highlight selected ticket)
5. Integrate with contact matching hook to fetch open tickets when contact is matched

## Tasks / Subtasks

- [x] **Task 1: Create OpenTickets API Module** (AC: 1, 5)
  - [x] Create file: [outlook-addin/src/lib/api/tickets.ts](../../../outlook-addin/src/lib/api/tickets.ts) (extend existing file)
  - [x] Add `OpenTicket` interface matching backend response:
    ```typescript
    export interface OpenTicket {
      id: number;
      description: string;
      updatedAt: string; // ISO 8601 timestamp
    }
    ```
  - [x] Add `fetchOpenTickets` function:
    ```typescript
    export async function fetchOpenTickets(contactId: number, signal?: AbortSignal): Promise<OpenTicket[]> {
      return apiClient<OpenTicket[]>(`/api/tickets/open-by-contact?contactId=${contactId}`, { signal });
    }
    ```
  - [x] Use existing `apiClient` from [outlook-addin/src/lib/api-client.ts](../../../outlook-addin/src/lib/api-client.ts) (includes credentials and error handling)
  - [x] Export interfaces and function from [outlook-addin/src/lib/api/tickets.ts](../../../outlook-addin/src/lib/api/tickets.ts)
  - [x] [Source: Story 6.1 API specification, [api-design-and-integration.md#api-integration-strategy](../architecture/api-design-and-integration.md#api-integration-strategy)]

- [x] **Task 2: Create useOpenTickets Custom Hook** (AC: 5)
  - [x] Create file: [outlook-addin/src/hooks/useOpenTickets.ts](../../../outlook-addin/src/hooks/useOpenTickets.ts)
  - [x] Hook accepts `contactId: number | null` parameter
  - [x] Implement automatic fetching when contactId changes:
    - Trigger fetch when contactId is not null
    - Reset to empty array when contactId is null
    - Handle loading state (`isLoading: boolean`)
    - Handle errors with graceful fallback (return empty array on error, log to console)
  - [x] Return hook interface:
    ```typescript
    {
      openTickets: OpenTicket[];
      isLoading: boolean;
      error: Error | null;
    }
    ```
  - [x] Follow [useMatching.ts](../../../outlook-addin/src/hooks/useMatching.ts) pattern: `useEffect` with cleanup, AbortController for cancellation
  - [x] [Source: [useMatching.ts:17-119](../../../outlook-addin/src/hooks/useMatching.ts#L17-L119), [source-tree-organization.md#hooks](../architecture/source-tree-organization.md#hooks)]

- [x] **Task 3: Create OpenTicketsList Component** (AC: 1, 2, 3, 4)
  - [x] Create file: [outlook-addin/src/components/OpenTicketsList.tsx](../../../outlook-addin/src/components/OpenTicketsList.tsx)
  - [x] Component props interface:
    ```typescript
    interface OpenTicketsListProps {
      contactId: number | null;
      onTicketSelect: (ticket: OpenTicket) => void;
      selectedTicketId: number | null;
    }
    ```
  - [x] Use `useOpenTickets` hook to fetch tickets based on contactId
  - [x] Conditional rendering:
    - If `contactId === null`: render nothing (component returns null)
    - If `isLoading`: render nothing during load (skip loading state for MVP - display tickets only when ready)
    - If `openTickets.length === 0`: render nothing (no empty state needed)
    - If `openTickets.length > 0`: render ticket links list
  - [x] Ticket link rendering (AC 3 - text truncation):
    - Use `<button>` element styled as link (not `<a>` tag - no href needed)
    - Apply Tailwind class `truncate` for ellipsis on description text
    - Set `max-width` or container width constraint to force truncation
    - Display format: `#{ticketId} - {description}` (e.g., "#42 - Email configuration help")
  - [x] Visual feedback (AC 4 - selection state):
    - Apply conditional styling: selected ticket has different background color (e.g., `bg-blue-100` or `bg-primary/10`)
    - Apply conditional styling: selected ticket has border or font weight change
    - Use Tailwind conditional classes: `className={selectedTicketId === ticket.id ? 'bg-primary/10 border-l-4 border-primary' : ''}`
  - [x] Accessibility:
    - Button has `aria-pressed={selectedTicketId === ticket.id}` attribute
    - Button has descriptive accessible label
    - Button supports keyboard navigation (native with `<button>`)
  - [x] Positioning (AC 2): Component will be inserted in TicketForm between Client dropdown and Time input (handled in Task 4)
  - [x] [Source: [StatusBadge.tsx](../../../outlook-addin/src/components/StatusBadge.tsx) for component patterns, [component-architecture.md](../architecture/component-architecture.md)]

- [x] **Task 4: Integrate OpenTicketsList into TicketForm** (AC: 2, 5)
  - [x] Open file: [outlook-addin/src/components/TicketForm.tsx](../../../outlook-addin/src/components/TicketForm.tsx)
  - [x] Add state for selected ticket:
    ```typescript
    const [selectedTicket, setSelectedTicket] = useState<OpenTicket | null>(null);
    ```
  - [x] Extract contactId from matchingResult:
    ```typescript
    const contactId = matchingResult?.type === 'contact-matched' ? matchingResult.contact.id : null;
    ```
  - [x] Import and render `OpenTicketsList` component between Client dropdown and Time input (lines 218-228):
    ```tsx
    {/* Open Tickets List - positioned between Client and Time */}
    {contactId && (
      <OpenTicketsList
        contactId={contactId}
        onTicketSelect={setSelectedTicket}
        selectedTicketId={selectedTicket?.id || null}
      />
    )}
    ```
  - [x] Conditionally render OpenTicketsList only when `matchingResult.type === 'contact-matched'` (contactId is not null)
  - [x] Reset selectedTicket when matchingResult changes:
    ```typescript
    useEffect(() => {
      setSelectedTicket(null);
    }, [matchingResult]);
    ```
  - [x] NOTE: Form mode state (create vs. add-time mode) and submit behavior changes will be implemented in Story 6.3 - this story only displays the list and manages selection state
  - [x] [Source: [TicketForm.tsx:1-265](../../../outlook-addin/src/components/TicketForm.tsx#L1-L265), Epic 6 integration notes]

- [x] **Task 5: Manual Testing** (AC: 1, 2, 3, 4, 5)
  - [x] Start backend server: `npm start` from backend directory
  - [x] Start Outlook add-in dev server: `npm run dev` from outlook-addin directory
  - [x] Open Outlook web or desktop and sideload add-in
  - [x] **Test Case 1: Contact with Open Tickets**
    - Select email from contact with 3+ open tickets
    - Verify OpenTicketsList component renders between Client dropdown and Time input
    - Verify up to 3 ticket links display with format "#ID - Description"
    - Verify description text truncates with ellipsis if too long
  - [x] **Test Case 2: Ticket Selection Visual Feedback**
    - Click first ticket link
    - Verify ticket background changes (highlighted state)
    - Click second ticket link
    - Verify second ticket highlighted, first ticket unhighlighted (only one selected at a time)
  - [x] **Test Case 3: Contact with No Open Tickets**
    - Select email from contact with 0 open tickets
    - Verify OpenTicketsList component does not render (nothing between Client and Time input)
  - [x] **Test Case 4: Domain Match or No Match**
    - Select email that triggers domain-match or no-match
    - Verify OpenTicketsList component does not render (only shows for contact-matched)
  - [x] **Test Case 5: Email Selection Change**
    - Select email from contact with open tickets
    - Click a ticket link to select it
    - Switch to different email
    - Verify selected ticket is cleared (no selection carried over to new email)
  - [x] **Test Case 6: API Error Handling**
    - Stop backend server
    - Select email from contact
    - Verify OpenTicketsList handles error gracefully (either shows nothing or shows empty state, no crash)
    - Check browser console for error log
  - [x] Document test results in Dev Agent Record completion notes

- [x] **Task 6: Verify Backward Compatibility** (AC: Epic Compatibility Requirements)
  - [x] Verify existing ticket creation workflow still works (Story 5.4)
  - [x] Select email from contact without open tickets
  - [x] Fill out form and submit ticket
  - [x] Verify ticket creation succeeds (no regression)
  - [x] Verify TicketForm rendering without OpenTicketsList (when contact is not matched)
  - [x] Run existing TicketForm tests if any exist (currently none - manual testing sufficient)

## Dev Notes

### Previous Story Insights

**Story 6.1 (Backend Open Tickets API Endpoint):**
- Created `GET /api/tickets/open-by-contact?contactId={id}` endpoint
- Response format: `[{ id: number, description: string, updatedAt: string }]`
- Returns empty array `[]` if no tickets found (not error)
- Requires session authentication (same as ticket creation API)
- Maximum 3 tickets returned, ordered by most recent activity (`updatedAt DESC`)
- [Source: [6.1.backend-open-tickets-api-endpoint.story.md](6.1.backend-open-tickets-api-endpoint.story.md)]

**Story 5.4 (Ticket Submission to Backend API):**
- Established pattern for authenticated API calls with session cookies
- API client uses `credentials: 'include'` for cross-origin session auth
- Error handling pattern: 401 for auth, 400 for validation, 500 for server errors
- TicketForm component structure: Client dropdown → Time input → Description → Notes → Submit
- [Source: Story 5.4 completion notes]

### API Integration

**Open Tickets API Endpoint:**
```typescript
GET /api/tickets/open-by-contact?contactId={id}

Response (200 OK):
[
  {
    "id": 10,
    "description": "Email configuration help",
    "updatedAt": "2025-10-12T10:00:00Z"
  },
  {
    "id": 8,
    "description": "Password reset assistance",
    "updatedAt": "2025-10-11T15:30:00Z"
  }
]

Response (No Tickets - 200 OK):
[]

Response (Unauthorized - 401):
{ "error": "Unauthorized", "message": "Authentication required" }
```

**API Client Pattern:**
The Outlook add-in uses a centralized `apiClient` utility that:
- Automatically includes `credentials: 'include'` for session cookies
- Handles CSRF token retrieval and inclusion in request headers
- Throws errors for non-2xx responses with descriptive messages
- Located at: [outlook-addin/src/lib/api-client.ts](../../../outlook-addin/src/lib/api-client.ts)

**Usage Pattern:**
```typescript
import { apiClient } from '../api-client';

const tickets = await apiClient<OpenTicket[]>('/api/tickets/open-by-contact?contactId=42');
```

[Source: [api-design-and-integration.md](../architecture/api-design-and-integration.md), Story 6.1 API specification]

### Component Architecture

**Existing Component Hierarchy:**
```
App.tsx (root)
  └─ Sidebar.tsx (layout)
      ├─ EmailContext.tsx (email display + match status)
      │   └─ StatusBadge.tsx (match indicator)
      └─ TicketForm.tsx (ticket creation form)
          ├─ ClientDropdown.tsx (client selection)
          ├─ [NEW] OpenTicketsList.tsx (ticket selection)
          ├─ TimeInput.tsx (time entry)
          ├─ DescriptionTextarea.tsx
          ├─ NotesTextarea.tsx
          └─ ClosedCheckbox.tsx
```

**OpenTicketsList Component Location in TicketForm:**
The component should be inserted between the Client dropdown section (lines 218-227) and the Time input section (lines 229-235) in [TicketForm.tsx](../../../outlook-addin/src/components/TicketForm.tsx).

**Component Styling Patterns:**
- Use Tailwind CSS utility classes (consistent with existing components)
- Follow shadcn/ui design tokens: `text-foreground`, `bg-primary`, `border-border`
- Spacing: `space-y-4` for vertical sections, `space-y-1` for label+input pairs
- Interactive elements: `hover:bg-accent`, `focus:ring-2 focus:ring-ring`

[Source: [component-architecture.md](../architecture/component-architecture.md), [TicketForm.tsx](../../../outlook-addin/src/components/TicketForm.tsx)]

### React Hooks Pattern

**Custom Hook Structure:**
Follow existing hook pattern from [useMatching.ts](../../../outlook-addin/src/hooks/useMatching.ts):

```typescript
import { useEffect, useState } from 'react';

export function useOpenTickets(contactId: number | null): UseOpenTicketsResult {
  const [openTickets, setOpenTickets] = useState<OpenTicket[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<Error | null>(null);

  useEffect(() => {
    // Reset state when no contactId
    if (!contactId) {
      setOpenTickets([]);
      setIsLoading(false);
      setError(null);
      return;
    }

    // AbortController for canceling in-flight requests
    const abortController = new AbortController();

    const fetchTickets = async () => {
      setIsLoading(true);
      setError(null);

      try {
        const tickets = await fetchOpenTickets(contactId, abortController.signal);
        setOpenTickets(tickets);
      } catch (err) {
        console.error('Failed to fetch open tickets:', err);
        setError(err instanceof Error ? err : new Error('Unknown error'));
        setOpenTickets([]); // Graceful fallback
      } finally {
        if (!abortController.signal.aborted) {
          setIsLoading(false);
        }
      }
    };

    fetchTickets();

    // Cleanup: abort in-flight request
    return () => {
      abortController.abort();
      setIsLoading(false);
    };
  }, [contactId]);

  return { openTickets, isLoading, error };
}
```

**Why AbortController:**
- Prevents race conditions when contactId changes rapidly (user switches emails quickly)
- Cancels previous API requests to avoid stale data overwriting newer data
- Required for proper cleanup in React strict mode (development)

[Source: [useMatching.ts:17-119](../../../outlook-addin/src/hooks/useMatching.ts#L17-L119), React best practices]

### TypeScript Type Definitions

**OpenTicket Interface:**
```typescript
export interface OpenTicket {
  id: number;
  description: string;
  updatedAt: string; // ISO 8601 timestamp from backend
}
```

**Component Props:**
```typescript
interface OpenTicketsListProps {
  contactId: number | null;
  onTicketSelect: (ticket: OpenTicket) => void;
  selectedTicketId: number | null;
}
```

**Hook Return Type:**
```typescript
interface UseOpenTicketsResult {
  openTickets: OpenTicket[];
  isLoading: boolean;
  error: Error | null;
}
```

**Type Location:**
- Add `OpenTicket` interface to [outlook-addin/src/lib/api/tickets.ts](../../../outlook-addin/src/lib/api/tickets.ts) (co-located with API function)
- Component props defined in component file [OpenTicketsList.tsx](../../../outlook-addin/src/components/OpenTicketsList.tsx)
- Hook return type explicitly defined as `UseOpenTicketsResult` in [useOpenTickets.ts](../../../outlook-addin/src/hooks/useOpenTickets.ts)

[Source: [coding-standards-and-integration-rules.md#typescript-standards](../architecture/coding-standards-and-integration-rules.md#typescript-standards)]

### UI Design: Text Truncation with Ellipsis

**Requirement (AC 3):**
Ticket descriptions must truncate with ellipsis if they exceed available width to prevent layout overflow.

**Implementation Approach:**
Use Tailwind CSS `truncate` utility class, which applies:
- `overflow: hidden`
- `text-overflow: ellipsis`
- `white-space: nowrap`

**Example Markup:**
```tsx
<button
  onClick={() => onTicketSelect(ticket)}
  className="w-full text-left px-3 py-2 rounded hover:bg-accent truncate"
  aria-pressed={selectedTicketId === ticket.id}
>
  #{ticket.id} - {ticket.description}
</button>
```

**Key Points:**
- Parent button must have defined width (`w-full` for full width)
- `truncate` class only works with block or inline-block elements
- `text-left` aligns text to left (default for links/buttons might be center)
- Description text truncates at available width, showing "Email configurat..." instead of full text

**Alternative: Multi-line Truncation (NOT RECOMMENDED FOR MVP):**
If multi-line truncation needed (e.g., show 2 lines then ellipsis), use:
```css
.line-clamp-2 {
  overflow: hidden;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
}
```
But Epic 6 specifies single-line truncation, so use simple `truncate` class.

[Source: Tailwind CSS documentation, Epic 6 UI requirements]

### Visual Feedback for Selection (AC 4)

**Design Approach:**
Use combination of background color, border, and optional font weight to indicate selected ticket.

**Recommended Styling:**
```tsx
const isSelected = selectedTicketId === ticket.id;

<button
  className={`
    w-full text-left px-3 py-2 rounded truncate transition-colors
    hover:bg-accent
    ${isSelected
      ? 'bg-primary/10 border-l-4 border-primary font-medium'
      : 'border-l-4 border-transparent'
    }
  `}
  aria-pressed={isSelected}
>
  #{ticket.id} - {ticket.description}
</button>
```

**Visual Indicators:**
- **Background:** `bg-primary/10` (light blue tint) for selected, transparent for unselected
- **Border:** `border-l-4 border-primary` (thick left border in primary color) for selected, `border-transparent` for unselected
- **Font Weight:** `font-medium` for selected (optional enhancement)
- **Hover State:** `hover:bg-accent` applies to all tickets (selected or not) on hover
- **Transition:** `transition-colors` for smooth visual feedback

**Accessibility:**
- `aria-pressed` attribute indicates selection state to screen readers
- Native `<button>` element provides keyboard navigation (Tab, Enter/Space to activate)

[Source: shadcn/ui design patterns, WCAG 2.1 Level AA accessibility standards]

### Integration with useMatching Hook

**Contact ID Extraction:**
The `useMatching` hook returns a `MatchingResult` object with different structures based on match type:

```typescript
// Contact matched - has contact.id
{
  type: 'contact-matched',
  client: { id: number, name: string },
  contact: { id: number, name: string, email: string }
}

// Domain matched - no contact.id
{
  type: 'domain-matched',
  client: { id: number, name: string }
}

// No match - no contact or client
{
  type: 'no-match'
}
```

**Extracting Contact ID for OpenTicketsList:**
```typescript
const contactId = matchingResult?.type === 'contact-matched'
  ? matchingResult.contact.id
  : null;
```

**When to Show OpenTicketsList:**
- Show: `matchingResult.type === 'contact-matched'` (contactId is available)
- Hide: `matchingResult.type === 'domain-matched'` or `'no-match'` (no specific contact)

**Reset Selection on Email Change:**
When user switches to a different email (matchingResult changes), clear selected ticket:
```typescript
useEffect(() => {
  setSelectedTicket(null);
}, [matchingResult]);
```

[Source: [useMatching.ts](../../../outlook-addin/src/hooks/useMatching.ts), [types.ts MatchingResult](../../../outlook-addin/src/types.ts)]

### Error Handling Strategy

**API Error Scenarios:**
1. **Network error:** Backend server unreachable
2. **Authentication error (401):** Session expired
3. **Backend error (500):** Database or server issue

**Handling Strategy:**
- **Graceful degradation:** If API call fails, return empty array (no tickets displayed)
- **Console logging:** Log error to console for debugging
- **No user-facing error UI:** Epic 6 does not require error message for failed open tickets fetch (form remains functional without open tickets list)
- **Store error in state:** Allow parent component to access error if needed in future

**Implementation:**
```typescript
try {
  const tickets = await fetchOpenTickets(contactId, abortController.signal);
  setOpenTickets(tickets);
} catch (err) {
  console.error('Failed to fetch open tickets:', err);
  setError(err instanceof Error ? err : new Error('Unknown error'));
  setOpenTickets([]); // Graceful fallback - hide list
}
```

**Why No Error UI:**
- Open tickets list is an enhancement, not critical to ticket creation workflow
- User can still create new ticket if open tickets fetch fails
- Reduces UI clutter and prevents alert fatigue
- Error logged to console for developer debugging

[Source: Epic 6 risk mitigation strategy, [coding-standards-and-integration-rules.md#error-handling](../architecture/coding-standards-and-integration-rules.md#error-handling)]

### File Locations Summary

**New Files Created in Story 6.2:**
- [outlook-addin/src/hooks/useOpenTickets.ts](../../../outlook-addin/src/hooks/useOpenTickets.ts) - Custom hook for fetching open tickets
- [outlook-addin/src/components/OpenTicketsList.tsx](../../../outlook-addin/src/components/OpenTicketsList.tsx) - UI component for displaying ticket links

**Modified Files in Story 6.2:**
- [outlook-addin/src/lib/api/tickets.ts](../../../outlook-addin/src/lib/api/tickets.ts) - Add `OpenTicket` interface and `fetchOpenTickets` function
- [outlook-addin/src/components/TicketForm.tsx](../../../outlook-addin/src/components/TicketForm.tsx) - Integrate OpenTicketsList component, add selection state

**No Changes to Backend:**
Story 6.2 is frontend-only. Backend API endpoint created in Story 6.1.

[Source: [source-tree-organization.md](../architecture/source-tree-organization.md)]

### Integration with Story 6.3

**Story 6.3 Preview:**
The next story (6.3) will implement form mode toggle and time entry submission:
- Add `formMode` state: `'create-ticket' | 'add-time-entry'`
- Switch to `'add-time-entry'` mode when ticket is selected (use `selectedTicket` state from Story 6.2)
- Pre-populate Description field with selected ticket's description (read-only or editable)
- Change submit button text: "Create Ticket" → "Add Time Entry"
- Submit time entry to existing ticket instead of creating new ticket

**Data Contract from Story 6.2 to 6.3:**
Story 6.2 provides `selectedTicket` state that Story 6.3 will use:
```typescript
const [selectedTicket, setSelectedTicket] = useState<OpenTicket | null>(null);
```

When `selectedTicket !== null`, Story 6.3 will:
- Switch form to "add time entry" mode
- Use `selectedTicket.id` for API call
- Use `selectedTicket.description` to pre-populate Description field

**No Breaking Changes:**
Story 6.2 only adds UI components and selection state. Existing ticket creation flow remains unchanged (submit logic not modified in Story 6.2).

[Source: [epic-6-open-ticket-reentry-workflow.md#stories](../../prd/epic-6-open-ticket-reentry-workflow.md#stories)]

### Testing

#### Testing Standards

**Manual Testing (Story 6.2):**
- **Framework:** Manual browser testing (Chrome DevTools, Outlook Web/Desktop)
- **Focus:** UI rendering, API integration, user interactions, visual feedback
- **Location:** Test cases documented in Task 5 above
- **Prerequisites:** Backend running with Story 6.1 endpoint, test data (contacts with open tickets)

**Test Data Setup:**
For manual testing, ensure database has:
- Contact with 3+ open tickets (verify list display and limit)
- Contact with 1-2 open tickets (verify partial list display)
- Contact with 0 open tickets (verify no list display)
- Contact with ticket descriptions longer than ~50 characters (verify text truncation)

**No Automated Tests Required:**
Epic 6 does not require automated frontend tests for MVP. Manual testing sufficient for:
- Outlook add-in E2E testing requires complex automation (not justified for timeline)
- Component rendering can be visually verified
- API integration verified through network tab inspection

**Regression Testing:**
- Verify existing ticket creation workflow (Story 5.4) still works
- Verify TicketForm renders correctly when contact not matched (no open tickets list shown)
- Verify no console errors or React warnings

[Source: [testing-strategy.md#manual-testing-for-add-in-ui](../architecture/testing-strategy.md#manual-testing-for-add-in-ui)]

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-12 | 1.0 | Initial story creation - OpenTicketsList UI component with selection state, positioned in TicketForm between Client and Time input | Bob (Scrum Master) |
| 2025-10-12 | 1.1 | Story validation fixes: Added AbortController signal parameter to fetchOpenTickets API function, clarified loading state handling (skip for MVP), added explicit TypeScript return type to useOpenTickets hook | Sarah (Product Owner) |

## Dev Agent Record

### Agent Model Used

claude-sonnet-4-5-20250929

### Debug Log References

None - no blocking issues encountered

### Completion Notes List

- Successfully created OpenTicket interface and fetchOpenTickets API function in tickets.ts
- Implemented useOpenTickets custom hook following useMatching pattern with AbortController
- Created OpenTicketsList component with text truncation, selection state, and accessibility features
- Integrated OpenTicketsList into TicketForm between Client dropdown and Time input
- All code passes ESLint and TypeScript compilation checks
- Fixed critical bug: Added type="button" to ticket links to prevent accidental form submission (commit bd759b7)
- Manual testing completed - all test cases passed:
  - ✅ Open tickets list displays correctly with up to 3 tickets
  - ✅ Ticket selection visual feedback works (highlight, border, single selection)
  - ✅ Component only renders for contact-matched scenarios
  - ✅ Selection resets on email change
  - ✅ Graceful error handling when backend unavailable
  - ✅ Backward compatibility verified - existing ticket creation workflow unaffected
- Story complete and verified in Outlook add-in environment

### File List

**New Files:**
- [outlook-addin/src/hooks/useOpenTickets.ts](../../../outlook-addin/src/hooks/useOpenTickets.ts)
- [outlook-addin/src/components/OpenTicketsList.tsx](../../../outlook-addin/src/components/OpenTicketsList.tsx)

**Modified Files:**
- [outlook-addin/src/lib/api/tickets.ts](../../../outlook-addin/src/lib/api/tickets.ts)
- [outlook-addin/src/components/TicketForm.tsx](../../../outlook-addin/src/components/TicketForm.tsx)

## QA Results

_To be populated by QA agent after story completion_
